<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Civ 7 Drafter</title>
  <meta name="description" content="The Ultimate Civ 7 Drafter. A tool that helps you with your multiplayer Civilization VII games.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Rowdies:wght@300;400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=coffee" />
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
      <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-NPEGPCPGB4"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-NPEGPCPGB4');
  </script>
  <style>
      body {
          background-color: #1E1E1E;
          color: #FFFFFF;
          font-family: 'Monaco', sans-serif;
          margin: 0;
          padding: 0;
          display: flex;
          justify-content: center;
          align-items: center;
          min-height: 100vh;
      }

      .container {
          position: sticky;
          top: 0;
          z-index: 1000;
          max-width: 750px;
          width: 100%;
          margin: 0 auto;
          padding: 20px;
          border-radius: 30px;
      }

      h1 {
          font-family: 'Rowdies', sans-serif;
          text-align: center;
          font-size: 42px;
          margin-bottom: -10px;
      }

      h2 {
          text-align: center;
          font-size: 16px;
          margin-bottom: 5px;
      }

      labelFoot {
        margin-right: 5px;
        font-size: 12px;
      }

      .parameters-box {
          border: 2px solid rgba(255,255,255,0.2);
          border-radius: 20px;
          background-color: #00253D;
          padding: 15px;
          margin-bottom: 20px;
          box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
      }

      hr {
          border: 0;               /* Usuń domyślną obwódkę */
          height: 2px;             /* Wysokość linii */
          background-color: rgba(255,255,255,0.2);  /* Kolor linii */
          margin: 10px 0;          /* Margines góra/dół */
      }

      .slider-row {
          display: flex;
          flex-direction: column;
          margin-bottom: 15px;
      }

      .slider-row label {
          font-size: 16px;
          margin-bottom: 5px;
      }

      input[type=checkbox] {
          margin-right: 10px;
      }

      .button {
          background-color: #007ACC;
          color: #FFFFFF;
          border: none;
          padding: 10px 20px;
          font-size: 20px;
          width: 100%;
          cursor: pointer;
          border-top-left-radius: 9999px;
          border-bottom-left-radius: 9999px;
          border-top-right-radius: 9999px;
          border-bottom-right-radius: 9999px;
      }

      .button:hover {
          background-color: #005F99;
      }

      .round-button {
          width: 70px;
          height: 70px;
          background-color: #DDEDAA;
          color: black;
          border: none;
          border-radius: 50%;
          font-size: 16px;
          cursor: pointer;
          display: flex;
          justify-content: center;
          align-items: center;
          box-shadow: 0 12px 12px rgba(0, 0, 0, 0.5);
      }
      .round-button:hover {
          background-color: #5F7718;
      }

      .button-tnp {
          background: transparent;
          width: 40px;
          height: 40px;
          border: 2px solid rgba(255,255,255,0.2);
          color: #DDEDAA;
          cursor: pointer;
          border-top-left-radius: 5px;
          border-bottom-left-radius: 5px;
          border-top-right-radius: 5px;
          border-bottom-right-radius: 5px;
      }
      .button-tnp:hover {
          background-color: #005F99;
      }

      .results-box {
          border: 2px solid rgba(255,255,255,0.2);
          border-radius: 20px;
          padding: 20px;
          margin-top: 20px;
          margin-bottom: 20px;
          position: relative;
      }

      .player {
          margin-bottom: 15px;
          padding: 10px;
          background-color: #3A3A3A;
          border-radius: 5px;
      }

      .player h3 {
          margin: 0 0 10px;
      }

      .leader {
          display: inline-flex;
          align-items: center;
          margin-right: 15px;
      }

      .leader img {
          width: 50px;
          height: 50px;
          margin-right: 10px;
          border-radius: 50%;
      }

      input[type=range] {
          width: 100%;
      }


      /* Styl dla sekcji zwijanej LEADERS */
      .collapsible-toggle {
          background: none;
          border: none;
          color: #FFFFFF;
          cursor: pointer;
          font-size: 15px;
          padding: 0;
          margin-bottom: 5px;
          display: flex;
          align-items: center;
      }
      .collapsible-toggle:focus {
          outline: none;
      }
      .collapsible-content {
          display: none; /* początkowo schowane */
      }

      /* Styl do sekcji radiobuttonów epok */
      .era-selection {
          display: flex;
          justify-content: space-evenly;
          margin: 10px 0;
      }
      .era-selection label {
          cursor: pointer;
          user-select: none;
      }
      .era-selection input[type="radio"] {
          margin-right: 5px;
      }
  </style>
</head>
<body>
  <div class="container">
      <h1 style="color: #DDEDAA;">CIVPIK</h1>
      <h2>Civilization VII Drafter</h2>

      <div class="parameters-box">
        <!-- Suwaki -->
        <div class="slider-row">
          <label for="numPlayers">
            # PLAYERS: <span id="numPlayersValue">1</span>
          </label>
          <input type="range" id="numPlayers" name="numPlayers" min="1" max="8" value="1" oninput="updatePlayerValue()">
        </div>
        <hr />
        <!-- Sekcja suwaka: Leaders per player -->
        <div class="slider-row" id="leadersSection">
          <label for="numLeaders">
            <input type="checkbox" id="useLeaders" checked>
            Leaders per player: <span id="numLeadersValue">1</span>
          </label>
          <input type="range" id="numLeaders" name="numLeaders" min="1" max="6" value="1" oninput="updateLeaderValue()">
        </div>

        <!-- Nowy suwak Civs per player + checkbox -->
        <div class="slider-row" id="civsSection">
          <label for="numCivs">
            <input type="checkbox" id="useCivs" checked>
            Civs per player: <span id="numCivsValue">1</span>
          </label>
          <input type="range" id="numCivs" name="numCivs" min="1" max="6" value="1" oninput="updateCivsValue()">
        </div>

        <!-- Wybór epoki cywilizacji (radio), przeniesiony niżej, zależny od useCivs -->
        <div class="era-selection" id="eraSelection">
          <label><input type="radio" name="civEra" value="Antiquity" checked>Antiquity</label>
          <label><input type="radio" name="civEra" value="Exploration">Exploration</label>
          <label><input type="radio" name="civEra" value="Modern">Modern</label>
        </div>
        <hr />

        <!-- Sekcja zwijana LEADERS -->
        
        <button type="button" class="collapsible-toggle" id="leadersToggle">► SETTINGS</button>
        <div class="collapsible-content" id="leadersContent">
          <label style="display: block;">--- DLCs ---</label>
          <label style="display: block;">
            <input type="checkbox" id="selectAllLeaders" checked>
            SELECT ALL
          </label>
          <label style="display: block;">
            <input type="checkbox" id="baseLeaders" checked disabled>
            Base game
          </label>
          <label style="display: block;">
            <input type="checkbox" id="deluxeLeaders" checked>
            Deluxe edition
          </label>
          <label style="display: block;">
            <input type="checkbox" id="foundersLeaders" checked>
            Founders edition
          </label>
          <label style="display: block;">
            <input type="checkbox" id="crossroadsLeaders" checked>
            Crossroads of the World
          </label>
          <br>
          <label style="display: block;">--- Options ---</label>
          <label style="display: block;"><input type="checkbox" id="allowDuplicateLeaders"> Allow duplicate leaders</label>
          <label style="display: block;"><input type="checkbox" id="allowDuplicateCivs" checked> Allow duplicate civs</label>
        </div>



        <div style="position: relative; text-align: center; margin-top: 20px;">
          <button class="button" onclick="showResults()" style="margin: 0 auto; display: inline-block;">Generate!</button>
        </div>
      </div>

      <div id="resultsContainer" class="results-box" style="display: none;">
          <div style="position: relative; text-align: center; margin-top: 0px;">
            <button class="round-button" id="copyButton" style="display: none; position: absolute; top: -10px; right: -10px;" onclick="copyResults()">
              <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="none" viewBox="0 0 24 24">
                <path stroke="currentColor" stroke-linejoin="round" stroke-width="1.8" d="M9 8v3a1 1 0 0 1-1 1H5m11 4h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-7a1 1 0 0 0-1 1v1m4 3v10a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1v-7.13a1 1 0 0 1 .24-.65L7.7 8.35A1 1 0 0 1 8.46 8H13a1 1 0 0 1 1 1Z"/>
              </svg>
            </button>
          </div>
          <div id="results"></div>
      </div>

      <div id="bottomFrame" style="display: flex; justify-content: space-between;">
        <div>
          <button class="button-tnp" onclick="window.open('https://github.com/kamil-cz/kamil-cz.github.io', '_blank')" style="display: inline-block;">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-github" viewBox="0 0 16 16">
            <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.01 8.01 0 0 0 16 8c0-4.42-3.58-8-8-8"/>
            </svg>
          </button>
          <button class="button-tnp" onclick="window.open('https://ko-fi.com/rogueal', '_blank')" style="display: inline-block;">
            <span class="material-symbols-outlined">
              coffee
            </span>
          </button>
          <button class="button-tnp" onclick="window.open('https://discord.gg/NGnEvtAg', '_blank')" style="display: inline-block;">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-discord" viewBox="0 0 16 16">
              <path d="M13.545 2.907a13.2 13.2 0 0 0-3.257-1.011.05.05 0 0 0-.052.025c-.141.25-.297.577-.406.833a12.2 12.2 0 0 0-3.658 0 8 8 0 0 0-.412-.833.05.05 0 0 0-.052-.025c-1.125.194-2.22.534-3.257 1.011a.04.04 0 0 0-.021.018C.356 6.024-.213 9.047.066 12.032q.003.022.021.037a13.3 13.3 0 0 0 3.995 2.02.05.05 0 0 0 .056-.019q.463-.63.818-1.329a.05.05 0 0 0-.01-.059l-.018-.011a9 9 0 0 1-1.248-.595.05.05 0 0 1-.02-.066l.015-.019q.127-.095.248-.195a.05.05 0 0 1 .051-.007c2.619 1.196 5.454 1.196 8.041 0a.05.05 0 0 1 .053.007q.121.1.248.195a.05.05 0 0 1-.004.085 8 8 0 0 1-1.249.594.05.05 0 0 0-.03.03.05.05 0 0 0 .003.041c.24.465.515.909.817 1.329a.05.05 0 0 0 .056.019 13.2 13.2 0 0 0 4.001-2.02.05.05 0 0 0 .021-.037c.334-3.451-.559-6.449-2.366-9.106a.03.03 0 0 0-.02-.019m-8.198 7.307c-.789 0-1.438-.724-1.438-1.612s.637-1.613 1.438-1.613c.807 0 1.45.73 1.438 1.613 0 .888-.637 1.612-1.438 1.612m5.316 0c-.788 0-1.438-.724-1.438-1.612s.637-1.613 1.438-1.613c.807 0 1.451.73 1.438 1.613 0 .888-.631 1.612-1.438 1.612"/>
            </svg>
          </button>
        </div>
        <div style="display: flex; align-items: center; justify-content: center; color: #007ACC;">
          <labelFoot style="color: #DDEDAA;">2025 by rogueal</labelFoot>
          <labelFoot style="color: #DDEDAA;">v0.3.1</labelFoot>
        </div>
      </div>
  </div>

  <script>
      // ------------------- LEADERS -------------------
      const baseLeaders = {
          "Amina": "https://static.wikia.nocookie.net/civilization/images/d/d8/Amina_%28Civ7%29.png",
          "Ashoka, World Renouncer": "https://static.wikia.nocookie.net/civilization/images/b/b2/Ashoka%2C_World_Renouncer_%28Civ7%29.png",
          "Augustus": "https://static.wikia.nocookie.net/civilization/images/9/99/Augustus_%28Civ7%29.png",
          "Benjamin Franklin": "https://static.wikia.nocookie.net/civilization/images/4/4c/Benjamin_Franklin_%28Civ7%29.png",
          "Catherine the Great": "https://static.wikia.nocookie.net/civilization/images/c/c5/Catherine_the_Great_%28Civ7%29.png",
          "Charlemagne": "https://static.wikia.nocookie.net/civilization/images/d/dd/Charlemagne_%28Civ7%29.png",
          "Confucius": "https://static.wikia.nocookie.net/civilization/images/c/c4/Confucius_%28Civ7%29.png",
          "Friedrich, Oblique": "https://static.wikia.nocookie.net/civilization/images/5/5f/Friedrich%2C_Oblique_%28Civ7%29.png",
          "Harriet Tubman": "https://static.wikia.nocookie.net/civilization/images/c/cf/Harriet_Tubman_%28Civ7%29.png",
          "Hatshepsut": "https://static.wikia.nocookie.net/civilization/images/0/05/Hatshepsut_%28Civ7%29.png",
          "Himiko, Queen of Wa": "https://static.wikia.nocookie.net/civilization/images/a/af/Himiko%2C_Queen_of_Wa_%28Civ7%29.png",
          "Ibn Battuta": "https://static.wikia.nocookie.net/civilization/images/2/27/Ibn_Battuta_%28Civ7%29.png",
          "Isabella": "https://static.wikia.nocookie.net/civilization/images/b/b3/Isabella_%28Civ7%29.png",
          "José Rizal": "https://static.wikia.nocookie.net/civilization/images/e/ea/Jos%C3%A9_Rizal_%28Civ7%29.png",
          "Lafayette": "https://static.wikia.nocookie.net/civilization/images/8/82/Lafayette_%28Civ7%29.png",
          "Napoleon, Emperor": "https://static.wikia.nocookie.net/civilization/images/f/ff/Napoleon%2C_Emperor_%28Civ7%29.png",
          "Napoleon, Revolutionary": "https://static.wikia.nocookie.net/civilization/images/4/4b/Napoleon%2C_Revolutionary_%28Civ7%29.png",
          "Machiavelli": "https://static.wikia.nocookie.net/civilization/images/6/6b/Machiavelli_%28Civ7%29.png",
          "Pachacuti": "https://static.wikia.nocookie.net/civilization/images/5/5f/Pachacuti_%28Civ7%29.png",
          "Tecumseh": "https://static.wikia.nocookie.net/civilization/images/0/08/Tecumseh_%28Civ7%29.png",
          "Trung Trac": "https://static.wikia.nocookie.net/civilization/images/2/2e/Trung_Trac_%28Civ7%29.png",
          "Xerxes, King of Kings": "https://static.wikia.nocookie.net/civilization/images/3/36/Xerxes%2C_King_of_Kings_%28Civ7%29.png"
      };

      const deluxeLeaders = {
          "Friedrich, Baroque": "https://static.wikia.nocookie.net/civilization/images/6/60/Friedrich%2C_Baroque_%28Civ7%29.png",
          "Xerxes, The Achaemenid": "https://static.wikia.nocookie.net/civilization/images/d/d5/Xerxes%2C_the_Achaemenid_%28Civ7%29.png"
      };

      const foundersLeaders = {
          "Ashoka, World Conqueror": "https://static.wikia.nocookie.net/civilization/images/1/19/Ashoka%2C_World_Conqueror_%28Civ7%29.png",
          "Himiko, High Shaman": "https://static.wikia.nocookie.net/civilization/images/1/15/Himiko%2C_High_Shaman_%28Civ7%29.png",
          "Friedrich, Baroque": "https://static.wikia.nocookie.net/civilization/images/6/60/Friedrich%2C_Baroque_%28Civ7%29.png",
          "Xerxes, The Achaemenid": "https://static.wikia.nocookie.net/civilization/images/d/d5/Xerxes%2C_the_Achaemenid_%28Civ7%29.png"
      };

      const crossroadsLeaders = {
          "Ada Lovelace": "https://static.wikia.nocookie.net/civilization/images/1/15/Ada_Lovelace_%28Civ7%29.png"
      };

      // ------------------- CIVS PODZIELONE NA 3 EPOKI -------------------
      const baseCivs = {
        "Antiquity": {
          "Aksumite": "https://static.wikia.nocookie.net/civilization/images/8/8f/Aksumite_%28Civ7%29.png",
          "Egyptian": "https://static.wikia.nocookie.net/civilization/images/1/19/Egyptian_%28Civ7%29.png",
          "Greek": "https://static.wikia.nocookie.net/civilization/images/0/02/Greek_%28Civ7%29.png",
          "Han": "https://static.wikia.nocookie.net/civilization/images/6/69/Han_%28Civ7%29.png",
          "Khmer": "https://static.wikia.nocookie.net/civilization/images/3/3e/Khmer_%28Civ7%29.png",
          "Mauryan": "https://static.wikia.nocookie.net/civilization/images/6/60/Mauryan_%28Civ7%29.png",
          "Maya": "https://static.wikia.nocookie.net/civilization/images/c/c2/Maya_%28Civ7%29.png",
          "Mississippian": "https://static.wikia.nocookie.net/civilization/images/5/52/Mississippian_%28Civ7%29.png",
          "Persian": "https://static.wikia.nocookie.net/civilization/images/9/97/Persian_%28Civ7%29.png",
          "Roman": "https://static.wikia.nocookie.net/civilization/images/9/9f/Roman_%28Civ7%29.png"
        },
        "Exploration": {
          "Abbasid": "https://static.wikia.nocookie.net/civilization/images/9/9c/Abbasid_%28Civ7%29.png",
          "Chola": "https://static.wikia.nocookie.net/civilization/images/6/61/Chola_%28Civ7%29.png",
          "Hawaiian": "https://static.wikia.nocookie.net/civilization/images/d/d9/Hawaiian_%28Civ7%29.png",
          "Incan": "https://static.wikia.nocookie.net/civilization/images/9/91/Incan_%28Civ7%29.png",
          "Majapahit": "https://static.wikia.nocookie.net/civilization/images/7/71/Majapahit_%28Civ7%29.png",
          "Ming": "https://static.wikia.nocookie.net/civilization/images/0/09/Ming_%28Civ7%29.png",
          "Mongolian": "https://static.wikia.nocookie.net/civilization/images/1/19/Mongolian_%28Civ7%29.png",
          "Norman": "https://static.wikia.nocookie.net/civilization/images/0/02/Norman_%28Civ7%29.png",
          "Shawnee": "https://static.wikia.nocookie.net/civilization/images/e/eb/Shawnee_%28Civ7%29.png",
          "Songhai": "https://static.wikia.nocookie.net/civilization/images/0/02/Songhai_%28Civ7%29.png",
          "Spanish": "https://static.wikia.nocookie.net/civilization/images/6/65/Spanish_%28Civ7%29.png"
        },
        "Modern": {
          "American": "https://static.wikia.nocookie.net/civilization/images/d/d6/American_%28Civ7%29.png",
          "Bugandan": "https://static.wikia.nocookie.net/civilization/images/1/13/Bugandan_%28Civ7%29.png",
          "French Imperial": "https://static.wikia.nocookie.net/civilization/images/a/a9/French_Imperial_%28Civ7%29.png",
          "Meiji Japanese": "https://static.wikia.nocookie.net/civilization/images/2/2e/Meiji_Japanese_%28Civ7%29.png",
          "Mexican": "https://static.wikia.nocookie.net/civilization/images/f/f6/Mexican_%28Civ7%29.png",
          "Mughal": "https://static.wikia.nocookie.net/civilization/images/5/5b/Mughal_%28Civ7%29.png",
          "Prussian": "https://static.wikia.nocookie.net/civilization/images/0/07/Prussian_%28Civ7%29.png",
          "Qing": "https://static.wikia.nocookie.net/civilization/images/6/69/Qing_%28Civ7%29.png",
          "Russian": "https://static.wikia.nocookie.net/civilization/images/a/a2/Russian_%28Civ7%29.png",
          "Siamese": "https://static.wikia.nocookie.net/civilization/images/e/e1/Siamese_%28Civ7%29.png"
        }
      };

      const deluxeCivs = {
        "Antiquity": {
        },
        "Exploration": {
        },
        "Modern": {
        }
      };

      const foundersCivs = {
        "Antiquity": {
        },
        "Exploration": {
        },
        "Modern": {
        }
      };

      const crossroadsCivs = {
        "Antiquity": {
          "Carthaginian": "https://static.wikia.nocookie.net/civilization/images/e/e6/Carthaginian_%28Civ7%29.png"
        },
        "Exploration": {
        },
        "Modern": {
          "British": "https://static.wikia.nocookie.net/civilization/images/9/95/British_%28Civ7%29.png"
        }
      };

      // ----------------- GENEROWANIE WYNIKÓW -----------------
      function showResults() {
          const numPlayers = parseInt(document.getElementById('numPlayers').value);

          // Czy używamy liderów i/lub cywilizacji?
          const useLeaders = document.getElementById('useLeaders').checked;
          const useCivs    = document.getElementById('useCivs').checked;

          // Odczytujemy suwaki tylko jeśli dane checkboxy są zaznaczone
          const numLeaders = useLeaders ? parseInt(document.getElementById('numLeaders').value) : 0;
          const numCivs    = useCivs    ? parseInt(document.getElementById('numCivs').value)   : 0;

          // Sprawdzamy, którą epokę cywilizacji wybrano
          const chosenEra = document.querySelector('input[name="civEra"]:checked').value;

          // Checkboxy na edycje/dodatki
          const includeDeluxeLeaders   = document.getElementById('deluxeLeaders').checked;
          const includeFoundersLeaders = document.getElementById('foundersLeaders').checked;
          const includeCrossroadsLeaders = document.getElementById('crossroadsLeaders').checked;

          // Checkboxy duplikacji
          const allowDuplicateLeaders = document.getElementById('allowDuplicateLeaders').checked;
          const allowDuplicateCivs    = document.getElementById('allowDuplicateCivs').checked;

          const resultsDiv = document.getElementById('results');
          const resultsContainer = document.getElementById('resultsContainer');
          const copyBtn = document.getElementById('copyButton');

          // Czyścimy poprzednie wyniki
          resultsDiv.innerHTML = '';
          resultsContainer.style.display = 'none';

          // Jeśli oba checkboksy są wyłączone, nic nie generujemy
          if (!useLeaders && !useCivs) {
              alert("You turned off both Leaders and Civs. There's nothing to generate!");
              return;
          }

          // ------------------ POBRANIE PULI DANYCH ------------------
          // 1) Liderzy
          let availableLeaders = {};
          if (useLeaders) {
              availableLeaders = { ...baseLeaders };
              if (includeDeluxeLeaders)   availableLeaders = { ...availableLeaders, ...deluxeLeaders };
              if (includeFoundersLeaders) availableLeaders = { ...availableLeaders, ...foundersLeaders };
              if (includeCrossroadsLeaders) availableLeaders = { ...availableLeaders, ...crossroadsLeaders };
          }
          const leaderKeys = Object.keys(availableLeaders);

          // 2) Cywilizacje (tylko z wybranej epoki)
          let availableCivs = {};
          if (useCivs) {
              // z base
              availableCivs = { ...baseCivs[chosenEra] }; 
              // deluxe
              if (includeDeluxeLeaders && deluxeCivs[chosenEra]) {
                availableCivs = { ...availableCivs, ...deluxeCivs[chosenEra] };
              }
              // founders
              if (includeFoundersLeaders && foundersCivs[chosenEra]) {
                availableCivs = { ...availableCivs, ...foundersCivs[chosenEra] };
              }
              // crossroads
              if (includeCrossroadsLeaders && crossroadsCivs[chosenEra]) {
                availableCivs = { ...availableCivs, ...crossroadsCivs[chosenEra] };
              }
          }
          const civKeys = Object.keys(availableCivs);

          // ------------------ SPRAWDZANIE PULI (bez duplikatów) ------------------
          if (useLeaders) {
              const totalLeadersNeeded = numPlayers * numLeaders;
              if (!allowDuplicateLeaders && totalLeadersNeeded > leaderKeys.length) {
                  alert('Not enough unique leaders available for the selected settings.');
                  return;
              }
          }

          if (useCivs) {
              const totalCivsNeeded = numPlayers * numCivs;
              if (!allowDuplicateCivs && totalCivsNeeded > civKeys.length) {
                  alert('Not enough unique civs available in selected era for the selected settings.');
                  return;
              }
          }

          // ------------------ URUCHOMIENIE WYNIKÓW ------------------
          resultsContainer.style.display = 'block';
          copyBtn.style.display = 'inline-block';

          // Kopie list do losowania globalnego
          let globalLeadersPool = [...leaderKeys];
          let globalCivsPool    = [...civKeys];

          // ------------------ LOSOWANIE ------------------
          for (let i = 1; i <= numPlayers; i++) {
              const playerDiv = document.createElement('div');
              playerDiv.className = 'player';

              const playerHeader = document.createElement('h3');
              playerHeader.textContent = `Civhead ${i}`;
              playerDiv.appendChild(playerHeader);

              // Liderzy
              if (useLeaders) {
                  let selectedLeaders = [];
                  let localLeadersPool = allowDuplicateLeaders
                    ? [...globalLeadersPool]
                    : globalLeadersPool;

                  for (let j = 0; j < numLeaders; j++) {
                      if (localLeadersPool.length === 0) break;

                      let chosenLeader = null;
                      let attempts = 0;
                      while (!chosenLeader && attempts < 1000) {
                          let randomIndex = Math.floor(Math.random() * localLeadersPool.length);
                          let candidate = localLeadersPool[randomIndex];
                          if (!selectedLeaders.includes(candidate)) {
                              chosenLeader = candidate;
                          }
                          attempts++;
                      }

                      if (chosenLeader) {
                          selectedLeaders.push(chosenLeader);
                          if (!allowDuplicateLeaders) {
                              const removeIndex = globalLeadersPool.indexOf(chosenLeader);
                              if (removeIndex > -1) {
                                  globalLeadersPool.splice(removeIndex, 1);
                              }
                          }
                          const localRemoveIndex = localLeadersPool.indexOf(chosenLeader);
                          if (localRemoveIndex > -1) {
                              localLeadersPool.splice(localRemoveIndex, 1);
                          }
                      }
                  }

                  // Wyświetlenie wylosowanych liderów
                  selectedLeaders.forEach(leader => {
                      const leaderDiv = document.createElement('div');
                      leaderDiv.className = 'leader';

                      const leaderImg = document.createElement('img');
                      leaderImg.src = availableLeaders[leader] || '#'; 

                      const leaderText = document.createElement('span');
                      leaderText.textContent = leader;

                      leaderDiv.appendChild(leaderImg);
                      leaderDiv.appendChild(leaderText);
                      playerDiv.appendChild(leaderDiv);
                  });
              }

              // Liniowy odstęp
              if (useLeaders && useCivs) {
                  const lineBreak = document.createElement('br');
                  playerDiv.appendChild(lineBreak);
              }

              // Cywilizacje
              if (useCivs) {
                  let selectedCivs = [];
                  let localCivsPool = allowDuplicateCivs
                    ? [...globalCivsPool]
                    : globalCivsPool;

                  for (let c = 0; c < numCivs; c++) {
                      if (localCivsPool.length === 0) break;

                      let chosenCiv = null;
                      let attempts = 0;
                      while (!chosenCiv && attempts < 1000) {
                          let randomIndex = Math.floor(Math.random() * localCivsPool.length);
                          let candidate = localCivsPool[randomIndex];
                          if (!selectedCivs.includes(candidate)) {
                              chosenCiv = candidate;
                          }
                          attempts++;
                      }

                      if (chosenCiv) {
                          selectedCivs.push(chosenCiv);
                          if (!allowDuplicateCivs) {
                              const removeIndex = globalCivsPool.indexOf(chosenCiv);
                              if (removeIndex > -1) {
                                  globalCivsPool.splice(removeIndex, 1);
                              }
                          }
                          const localRemoveIndex = localCivsPool.indexOf(chosenCiv);
                          if (localRemoveIndex > -1) {
                              localCivsPool.splice(localRemoveIndex, 1);
                          }
                      }
                  }

                  // Wyświetlenie wylosowanych cywilizacji
                  selectedCivs.forEach(civ => {
                      const civDiv = document.createElement('div');
                      civDiv.className = 'leader';

                      const civImg = document.createElement('img');
                      civImg.src = availableCivs[civ] || '#';

                      const civText = document.createElement('span');
                      civText.textContent = civ;

                      civDiv.appendChild(civImg);
                      civDiv.appendChild(civText);
                      playerDiv.appendChild(civDiv);
                  });
              }

              resultsDiv.appendChild(playerDiv);
          }
      }

      // ----------------- KOPIOWANIE WYNIKÓW -----------------
      function copyResults() {
        const results = document.getElementById('results');

        html2canvas(results, {
          useCORS: true,
          backgroundColor: '#1E1E1E' // Ustawienie koloru tła
        }).then(canvas => {
          canvas.toBlob(blob => {
            const item = new ClipboardItem({ 'image/png': blob });
            navigator.clipboard.write([item])
              .then(() => {
                alert('Screenshot copied to clipboard as PNG!');
              })
              .catch(err => {
                console.error('Failed to copy: ', err);
              });
          }, 'image/png');
        });
      }

      // ----------------- SLIDERY -----------------
      function updatePlayerValue() {
          const numPlayers = document.getElementById('numPlayers').value;
          document.getElementById('numPlayersValue').textContent = numPlayers;
      }

      function updateLeaderValue() {
          const numLeaders = document.getElementById('numLeaders').value;
          document.getElementById('numLeadersValue').textContent = numLeaders;
      }

      function updateCivsValue() {
          const numCivs = document.getElementById('numCivs').value;
          document.getElementById('numCivsValue').textContent = numCivs;
      }

      // ----------------- ROZWIJANIE/ZWIJANIE LEADERS -----------------
      const leadersToggle = document.getElementById('leadersToggle');
      const leadersContent = document.getElementById('leadersContent');

      leadersToggle.addEventListener('click', function() {
          if (leadersContent.style.display === 'none' || !leadersContent.style.display) {
              leadersContent.style.display = 'block';
              leadersToggle.textContent = '▼ SETTINGS';
          } else {
              leadersContent.style.display = 'none';
              leadersToggle.textContent = '► SETTINGS';
          }
      });

      // ----------------- SELECT ALL LEADERS -----------------
      const selectAllLeadersCheckbox = document.getElementById('selectAllLeaders');
      const deluxeLeadersCheckbox   = document.getElementById('deluxeLeaders');
      const foundersLeadersCheckbox = document.getElementById('foundersLeaders');

      selectAllLeadersCheckbox.addEventListener('change', () => {
        deluxeLeadersCheckbox.checked   = selectAllLeadersCheckbox.checked;
        foundersLeadersCheckbox.checked = selectAllLeadersCheckbox.checked;
      });

      [deluxeLeadersCheckbox, foundersLeadersCheckbox].forEach(cb => {
        cb.addEventListener('change', () => {
          if (!deluxeLeadersCheckbox.checked || !foundersLeadersCheckbox.checked) {
            selectAllLeadersCheckbox.checked = false;
          } else {
            selectAllLeadersCheckbox.checked = true;
          }
        });
      });

      // ----------------- AKTYWACJA / DEZAKTYWACJA SUWAKÓW I EPOK -----------------
      const useLeadersCheckbox = document.getElementById('useLeaders');
      const leadersSection     = document.getElementById('leadersSection');
      const numLeadersSlider   = document.getElementById('numLeaders');

      const useCivsCheckbox  = document.getElementById('useCivs');
      const civsSection      = document.getElementById('civsSection');
      const numCivsSlider    = document.getElementById('numCivs');
      const eraSelectionDiv  = document.getElementById('eraSelection');
      const eraRadioButtons  = document.getElementsByName('civEra');

      useLeadersCheckbox.addEventListener('change', () => {
        if (useLeadersCheckbox.checked) {
          leadersSection.style.opacity = '1';
          numLeadersSlider.disabled = false;
        } else {
          leadersSection.style.opacity = '0.4';
          numLeadersSlider.disabled = true;
        }
      });

      useCivsCheckbox.addEventListener('change', () => {
        if (useCivsCheckbox.checked) {
          civsSection.style.opacity = '1';
          numCivsSlider.disabled = false;

          eraSelectionDiv.style.opacity = '1';
          eraRadioButtons.forEach(rb => rb.disabled = false);
        } else {
          civsSection.style.opacity = '0.4';
          numCivsSlider.disabled = true;

          eraSelectionDiv.style.opacity = '0.4';
          eraRadioButtons.forEach(rb => rb.disabled = true);
        }
      });
  </script>
</body>
</html>
